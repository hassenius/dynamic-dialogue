---
name: "Context Driven Dialog Toolchain"
description: "Context Driven Dialog reference application Toolchain. \n\
In this window, you will be asked to specify the following properties for your toolchain: \n\n\
1. Specify a name for your toolchain that is __unique__ among all toolchains on your Bluemix namespace DevOps section. \n\
2. Click on the __GitHub__ icon. This opens the GitHub settings. Please, give your desired name to the repo that will be cloned. \n\
3. Click on the __Delivery Pipeline__ icon. This opens the delivery pipeline settings: \n\n\
\t - Specify the __Bluemix domain__ where your app will be hosted *(by default: mybluemix.net)*. \n\
\t - Specify the __build branch__ you would like your delivery pipelines to build the code from *(by default: master)*. \n\
4. Click the Create button to complete the toolchain creation."
version: 0.1
image: data:image/svg+xml;base64,$file(arch.svg,base64)
icon: data:image/svg+xml;base64,$file(icon.svg,base64)
toolchain:
  name: "context_driven_dialog_toolchain"
required:
 - deploy

#Github repo
context-driven-dialog:
  service_id: githubpublic
  parameters:
    repo_name: "context-driven-dialog-clone"
    repo_url: "https://github.com/hassenius/dynamic-dialogue"
    type: clone
  has_issues: false

# Pipelines
pipeline-wfd-eureka-cf:
  service_id: pipeline
  parameters:
    name: "Context Driven Dialog"
    ui-pipeline: true
    configuration:
      content: $file(context_driven_dialog_pipeline.yml)
      env:
       # Build java stage env variables
       REPO: "context-driven-dialog"
       BRANCH: "{{deploy.parameters.branch}}"
       # Build Deploy CF App stage env variables
       REGION: "{{deploy.parameters.deploy-region}}"
       ORG: "{{deploy.parameters.deploy-organization}}"
       SPACE: "{{deploy.parameters.deploy-space}}"
       ROUTE_DOMAIN: "{{deploy.parameters.route-domain}}"
    services: ["git"]
  hidden: [form, description]




deploy:
  schema:
    $ref: deployment_schema.json
  service-category: pipeline
  parameters:
    deploy-region: "{{region}}"
    deploy-organization: "{{organization}}"
    deploy-space: "{{space}}"
    branch: "master"



