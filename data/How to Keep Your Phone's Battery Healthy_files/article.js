define("modules/ArticleEmbeds",["modules/jquery-and-plugins","underscore","modules/Recommendations","modules/shop/Shop"],function(a,b,c,d){"use strict";var e=function(){var e,f,g,h,i,j,k=4,l=3;return{recommendationsFragment:null,recommendationsTemplate:null,setupRecommendations:function(){var d,e=a("<div></div>"),f=this.options;this.recommendationsFragment=e,this.recommendationsTemplate=b.template(a("#module-story--template").text()),d=f.containerCount>=f.secondaryContainerCount?f.containerCount*f.storyCount:f.secondaryContainerCount*f.secondaryStoryCount,c.getStories(d,this.handleRecommendationsResponse.bind(this))},handleRecommendationsResponse:function(c){var d=a("<div></div>"),e=this;b.each(c,function(a){a.image&&d.append(e.recommendationsTemplate(a))}),this.recommendationsFragment.append(d.children()),this.insertRecommendations()},insertRecommendations:function(){var c=this.recommendationsFragment.children(),d=this.options,e=-1,f=-1,g=0;b.each(c,function(){g%d.storyCount===0&&e++,g%d.secondaryStoryCount===0&&f++,e>d.containerCount&&f>d.secondaryContainerCount||(e<=d.containerCount&&c.eq(g).appendTo(d.recircs.eq(e).find(".module-story-list--stories")),f<=d.secondaryContainerCount&&(c.eq(g).find(".link-txt").html(c.eq(g).find(".link").prop("title")),c.eq(g).clone().appendTo(d.secondaryRecircs.eq(f).find(".module-story-list--stories"))),g++)}),a.event.trigger({type:"render.app.recommendations-success"})},loadRecircs:function(){var b=a(".module-story-list--stories:not(:has(*))");return e=b.parents(".recirc-standard-primary"),f=e.length,g=b.parents(".recirc-standard-secondary"),h=g.length,i=b.parents(".recirc-collection-secondary"),j=i.length,a(".hide-inline-recirc").length>0||1>f+h?(h&&g.hide(),j&&i.hide(),!1):(b.parents(".standard-article-body--container").length>0&&(k=3,l=k),this.options={recircs:e,containerCount:f,storyCount:k,secondaryRecircs:g,secondaryContainerCount:h,secondaryStoryCount:h>0?l:0},void this.setupRecommendations())},init:function(){d.loadAll(),a("#themes-recirc-primary").data("stories")>0||a("#themes-recirc-secondary").data("stories")>0||(1===a(".buzzing-recirc").data("section-enabled")?setTimeout(function(b){a("#buzzing-recirc-suppress-section").length&&a(".buzzing-recirc").data("section-enabled",0),b.loadRecircs()},250,this):this.loadRecircs())}}}();return e}),define("apis/Brightcove",["jquery","modules/Debounce"],function(a,b){"use strict";var c=function(){function d(a){for(var b=a.target.experience.id,c=0;c<q.length;c++)if(q[c]!==b){var d=k.api.getExperience(q[c]),e=d.getModule(l.VIDEO_PLAYER);e.pause(!0)}}function e(b,c){var d="BrightcoveExperience";b=b?b.hasClass(d)?b:b.find("."+d):a("."+d),b.length&&b.each(function(){var b,d=a(this),e=k.api.getExperience(d.attr("id"));if(e){if(b=e.getModule(l.VIDEO_PLAYER),"play"===c)return void b.play();if(d.attr("paused")&&"pause"!==c)return b.pause(),void d.removeAttr("paused");b.pause(!0),d.attr("paused",!0)}})}function f(b){var d="video-frame";return b=b?b.hasClass(d)?b:b.find("."+d):a("."+d),b.length?k?void b.each(function(b){var c=a(this),d=c.data("experience-id"),e="bc_",f=a("<div/>",{"class":"video-embed"}),g={bgcolor:c.data("video-bgcolor"),width:c.data("video-width"),height:c.data("video-height"),autoStart:c.data("autostart"),playerID:c.data("player-id"),playerKey:c.data("player-key"),templateLoadHandler:"onBrightcoveTemplateLoad",templateReadyHandler:"onBrightcoveTemplateComplete",wmode:"transparent",includeAPI:!0,videoSmoothing:!0,optimizedContentLoad:!0,isVid:!0,isUI:!0,dynamicStreaming:!0};e+=d?d:b+1;try{k.removeExperience(e)}catch(h){}c.data("playlist-id")&&c.data("featured-id")?(g["@videoList"]=c.data("playlist-id"),g["@videoList.featured"]=c.data("featured-id")):c.data("playlist-id")?g["@videoList"]=c.data("playlist-id"):g["@videoPlayer"]=c.data("video-id");var i=document.createDocumentFragment();for(var j in g)g.hasOwnProperty(j)&&i.appendChild(a("<param/>",{name:j,value:g[j]})[0]);f.append(a("<object/>",{id:e,"class":"BrightcoveExperience",html:i})),c.append(f),k.createExperiences()}):void c.init():void 0}function g(b){b||(b=a(".BrightcoveExperience")),b.each(function(){var b,c=a(this),d=c.parent().width(),e=Math.round(9*d/16),f=k.api.getExperience(c.attr("id"));c.height()!==e&&(c.css("height",e),f&&(b=f.getModule(l.EXPERIENCE),"html"===b.experience.type&&b.setSize(d,e)))})}function h(b){var c=a(window).scrollTop(),d=c+a(window).height(),e=a(b).offset().top,f=e+a(b).height();return f>=c&&d>=e&&d>=f/2&&2*e>=c}function i(){h(n)&&m===!1&&(m=!0,f(),g())}function j(){m&&g()}var k,l,m,n,o="//admin.brightcove.com/js/BrightcoveExperiences.js",p="//admin.brightcove.com/js/api/SmartPlayerAPI.js",q=[];return window.onBrightcoveTemplateLoad=function(b){a(document).trigger("load.app.brightcove",{id:b}),q.indexOf(b)<0&&q.push(b)},window.onBrightcoveTemplateComplete=function(b){a(document).trigger("complete.app.brightcove",{event:b});var c=k.api.getExperience(b.target.experience.id),e=c.getModule(l.VIDEO_PLAYER);e.addEventListener(k.api.events.MediaEvent.PLAY,function(a){d(a)}),e.addEventListener(k.api.events.MediaEvent.COMPLETE,function(b){a(window).trigger({type:"complete.video.brightcove",id:b.media.id})})},{init:function(){a(".video-frame").length>=1&&require([o,p],function(){k=window.brightcove,l=k.api.modules.APIModules,m=!1,n=document.getElementsByClassName("video-frame"),h(n)&&m===!1&&(m=!0,f(),g()),b.on("scroll","videoScroll",i),b.on("resize","videoResize",j)})},renderPlayer:f,resize:g,player:e}}();return c}),define("modules/LeftRail",["jquery","underscore","modules/Utils","modules/Debounce","modules/Recommendations"],function(a,b,c,d,e){"use strict";var f,g=window.Modernizr;return{isScrollBound:!1,bodies:[],bodyContainerSelector:".article-body--container",bodyContentSelector:".article-body--content",fixedAnchorPosition:0,windowHeight:0,placeholder:null,recommendationsFragment:null,recommendationsTemplate:null,setupBodyElements:function(){var b=a(this.bodyContainerSelector),c=this;[].pop.apply(b),b.each(function(){var b=a(this),d=b.find(c.bodyContentSelector),e=b.offset(),f=d.height();c.bodies.push({container:b,content:d,top:e.top,left:e.left,height:f,bottom:e.top+f})})},updateBodyElements:function(){var a=this;b.each(this.bodies,function(c,d){var e=c.container.offset(),f=c.content.height();b.extend(c,e,{height:f,bottom:e.top+f}),c.hasOwnProperty("rail")&&(c.railOrigin=1>d?a.placeholder.position().top:0)})},setupRailElements:function(){for(var c=a("#share-sticky"),d=[c],e=1,f=this.bodies.length;f>e;e++)d[e]=c.clone(!0).attr("id","").addClass("share-sticky share-sticky-clone");b.each(this.bodies,function(a,b){a.rail=d[b],b>0&&a.container.prepend(a.rail),a.railOrigin=a.rail.position().top})},bindEventHandlers:function(){d.on("resize","left-rail",a.proxy(this.handleResize,this)),a(window).on("render.app.body-change",a.proxy(this.handleResize,this)),!g.tablet&&this.isDesktopViewport()&&this.bindScroll()},bindScroll:function(){d.on("scroll","left-rail",a.proxy(this.handleScroll,this)),this.isScrollBound=!0},unbindScroll:function(){d.off("scroll","left-rail"),this.isScrollBound=!1},handleResize:function(){var a=this.windowHeight<window.innerHeight;if(this.windowHeight=window.innerHeight,this.isDesktopViewport()){if(this.updateBodyElements(),this.fixRailHeight(),this.isScrollBound||this.bindScroll(),null===this.recommendationsFragment&&this.setupRecommendations(),null===this.recommendationsFragment)return;this.recommendationsFragment.width(this.placeholder.width()),a&&this.insertRecommendations()}else this.isScrollBound&&(this.unbindScroll(),b.each(this.bodies,function(a){a.rail.css("height","")}))},handleScroll:function(a){var c=this,d=a+this.fixedAnchorPosition;this.updateBodyElements(),this.fixRailHeight(),b.each(this.bodies,function(a){var b,e;b=a.rail,e=b.css("position"),"fixed"===e?(d<=a.top+a.railOrigin&&c.resetRail(a),d+b.height()>=a.bottom&&c.detachRail(a)):"absolute"===e?d<=b.offset().top&&c.affixRail(a):d>=b.offset().top&&a.height-a.railOrigin>b.height()&&d<=a.bottom&&c.affixRail(a)})},resetRail:function(a){a.rail.css({position:"",top:"",width:""})},affixRail:function(a){a.rail.css({position:"fixed",top:this.fixedAnchorPosition,width:this.placeholder.width()})},detachRail:function(a){a.rail.css({position:"absolute",top:a.height-a.rail.height(),width:""})},setFixedAnchorPosition:function(){var b=a(".nav").first().outerHeight(!0);this.fixedAnchorPosition=b+10},isDesktopViewport:function(){return c.mq>=980},fixRailHeight:function(){var a=this;b.each(this.bodies,function(b){var c,d,e;c=b.rail.height(),e=b.height-b.railOrigin,d=g.tablet?e:Math.min(e,a.windowHeight-a.fixedAnchorPosition),d!==c&&(b.rail.height(d),a.recycleStoryOverflow(b))})},recycleStoryOverflow:function(b){var c,d=b.rail,e=d.find(".module-story"),f=d.height();e=e.get().reverse();for(var g=0,h=e.length;h>g&&(c=a(e[g]),c.position().top+c.height()>f);g++)c.appendTo(this.recommendationsFragment)},setupRecommendations:function(){if(!f){var c=a("<div></div>");c.addClass("left-rail left-rail-recommendations-fragment"),c.width(this.placeholder.width()),this.bodies[0].container.append(c),this.recommendationsFragment=c,this.recommendationsTemplate=b.template(a("#module-story--template").text()),this.requestRecommendations(20)}},requestRecommendations:function(b){e.getStories(b,a.proxy(this.handleRecommendationsResponse,this))},handleRecommendationsResponse:function(c){var d=a("<div></div>"),e=this;b.each(c,function(a){d.append(e.recommendationsTemplate(a))}),this.recommendationsFragment.append(d.children()),this.insertRecommendations()},insertRecommendations:function(){var c=[],d=this;b.each(this.bodies,function(a){c.push(d.determineSpaceInRail(a.rail))});for(var e,f,g,h,i=this.recommendationsFragment.children(),j=[],k=0,l=0,m=!1,n=0,o=c.length;o>n;n++){e=[];for(var p=k,q=i.length;q>p;p++){if(f=a(i[p]),g=f.position().top,h=f.outerHeight(!0),!(c[n]>=g+h-l)){k=p,l=g;break}e.push(p),p+1>=q&&(m=!0)}if(j.push(e),m)break}b.each(j,function(a,c){var e=d.bodies[c].rail;b.each(a,function(a){i.eq(a).appendTo(e.find(".left-rail--story-container"))})}),a(window).trigger("render.app.left-rail"),m&&(console.log("LeftRail: Ran out of recommendations. Requesting more."),this.requestRecommendations(20))},determineSpaceInRail:function(a){var b,c;return c=a.children().last(),b=a.height(),c.length<1?b:b-(c.position().top+c.outerHeight(!0))},init:function(){return f=a(".hide-left-rail-articles").length>0?!0:!1,a("#share-sticky").length<1||g.mobile||a(".article-body.show-left-rail").length<1?!1:(this.windowHeight=window.innerHeight,this.placeholder=a("#share-sticky--placeholder"),this.setFixedAnchorPosition(),this.setupBodyElements(),this.setupRailElements(),this.isDesktopViewport()&&(this.fixRailHeight(),this.setupRecommendations()),void this.bindEventHandlers())}}}),define("modules/StickyShare",["jquery","underscore","modules/Utils","modules/Debounce"],function(a,b,c,d){"use strict";var e=function(){function b(a){var b;a=a.currentScroll?a.currentScroll:a,b=a-h>0?"down":"up",h=a,("down"===b&&i===!1||"up"===b&&i===!0)&&(a>g?(f.addClass("stuck"),i=!0):(f.removeClass("stuck"),i=!1)),e.$transporter.length&&e.isTransporterVisible()&&(f.removeClass("stuck"),i=!1),e.isDesktopForFancySlide()?f.addClass("fancyslide"):f.removeClass("fancyslide")}var f,g=.8*window.innerHeight,h=0,i=!1;return{$transporter:a("#transporter"),isTransporterVisible:function(){return a.inviewport(this.$transporter,{threshold:0,container:window})||a.abovethetop(this.$transporter,{threshold:0,container:window})?!0:!1},isDesktopForFancySlide:function(){return c.mq>=c.mqs.desktop?!0:!1},init:function(){f=a("#share-sticky-bar"),f.length&&(d.on("scroll","win",b),a(document).on("applyStickyElements",b))}}}();return e}),define("modules/shop/Shop",["jquery","underscore","modules/Modal","modules/Utils","modules/Debounce","hammer"],function(a,b,c,d,e,f){"use strict";var g=function(){return{shopModal:"#modal-shop",modalImage:".modal-shop--product-image",slideButtonsClass:".slide-buy--button",modalButtonsBound:!1,$windowObj:null,loadAll:function(){var b=this,c=0,d=a(".shop-container");this.bindNonShopContainerTrackingEvents(),d.length&&d.each(function(){var e=a(this);b.getData(e,function(){c++,c===d.length&&b.postBuild()})})},getData:function(c,e){var f,h=this;if(this.isExpired(c))return void c.hide();f="modules/shop/Shop"+d.capitalize(c.data("source"),!0);try{require([f],function(d){var f=!1,i=a("body");c.html('<div class="shop-loader"><i class="icon icon-m icon-loader link-icon"></i></div>');try{d.getData(c,function(a){if(!a&&b.isFunction(e))return e(d,null);if(b.isEmpty(a))c.hide();else{var j=h.normalizeData(c,d,a);try{h.buildHTML(c,j)}catch(k){console.log("Build HTML : ",k)}b.isFunction(d.postBuild)&&d.postBuild(c,j),f=c.parent().hasClass("gallery-slide--shop")&&!i.hasClass("listview-active")||c.parent().hasClass("listicle--media")&&i.hasClass("listview-active")||c.parent().hasClass("article-body--text"),f&&g.$windowObj.trigger({type:"track.shop.loaded",source:c.data("source"),products:h.getOrderedProductNames(j.products)})}"function"==typeof e&&e(d,a)})}catch(j){console.log("Provider Data Error: ",j)}})}catch(i){console.log("Require error: ",i)}},getOrderedProductNames:function(a){var b=[];for(var c in a)b.push(a[c].name);return b},normalizeData:function(a,c,d){var e=c.normalizeData(a,d),f="Shop the Story",g=a.data("source");b.isEmpty(a.data("headline"))?b.isEmpty(e.headline)||(f=e.headline):f=a.data("headline");for(var h={headline:f,products:e.products,shopSource:g},i=0;i<h.products.length;i++){var j=h.products[i];b.isUndefined(j.buttonLabel)&&(j.buttonLabel="Shop Now")}return h},isExpired:function(a){var c=new Date;if(b.isEmpty(a.data("expiration")))return!1;var d=Date.parse(a.data("expiration"));return c>d},buildHTML:function(b,c){var e;null===g.$windowObj&&(g.$windowObj=a(window)),b.empty().addClass(this.getColumnClass(c.products.length)).html(d.renderTemplate("shop--template",c)),e=b.find(".shop-products--results"),e.on("click",".shop-item--wrap",{productData:c},this.buildModal.bind(g)),0===e.length&&(e=b),this.bindNonModalTrackingEvents(e)},buildModal:function(b){b.preventDefault(),b.stopPropagation();var c=a(b.currentTarget),e=a("#modal-shop div.modal-content"),f=a(".shop-item--wrap"),g=c.attr("href"),h=c.attr("target"),i=c.closest(".shop-products--results").data("id"),j=b.data.productData.products[i],k=d.setTemplate(d.getTemplate("modal-shop--template"),j);d.mq<d.mqs.desktop||Modernizr.touch?(e.empty().append(k),this.openModal(),this.bindEventHandlers(),this.fireModalOpenTrackingEvent(),this.bindModalDestinationURLClickthruEvent()):(window.open(g,h),f.removeClass("active"),c.addClass("active"))},bindNonShopContainerTrackingEvents:function(){a(document).on("click",this.slideButtonsClass,function(){a(window).trigger({type:"track.buy.button.clickthru",destinationURL:a(this).attr("href")})})},bindNonModalTrackingEvents:function(b){void 0!==typeof b&&(b.on("mouseenter","a.shop-item--wrap",function(){g.$windowObj.trigger({type:"track.shop.item.hovered",productName:a(this).data("product-name")})}),b.on("click","a.shop-item--wrap",function(){g.$windowObj.trigger({type:"track.shop.item.clickthru",destinationURL:a(this).attr("href")})}))},fireModalOpenTrackingEvent:function(){var b=a(this.shopModal);g.$windowObj.trigger({type:"track.shop.item.modal.open",productName:b.find(".modal-shop--button-wrap a").data("product-name")})},bindModalDestinationURLClickthruEvent:function(){var b=a(this.shopModal);b.on("click",".modal-shop--button-wrap a",function(){g.$windowObj.trigger({type:"track.shop.item.modal.clickthru",destinationURL:a(this).attr("href")})})},bindEventHandlers:function(){var a=document.querySelector("#modal-shop-close"),b=new f(a);b.on("tap",g.closeModal),Modernizr.touch?e.on("orientationchange","shop-modal-resize",g.handleResizeModal):e.on("resize","shop-modal-resize",g.handleResizeModal)},modal:function(b){var c=a(this.shopModal);c.length&&b&&c.trigger(b+".app.modal")},openModal:function(){this.handleResizeModal(),g.modal("show"),a("body").css("overflow","hidden")},closeModal:function(){g.modal("hide"),a("body").css("overflow","visible"),a("body").css("overflow-x","hidden")},sizeModal:function(){var b=g.$windowObj.height(),c=a(this.modalImage).css("max-height");a(this.modalImage).find("img").css("max-height",b*parseFloat(c)/100)},handleResizeModal:function(){d.mq<d.mqs.desktop||Modernizr.touch?(g.sizeModal(),g.$windowObj.width()>g.$windowObj.height()?a(".modal-content").addClass("notransform"):a(".modal-content").removeClass("notransform")):(a(".modal-overlay").hide(),g.closeModal())},postBuild:function(){c.init("#modal-shop"),c.init("#modal-reviews")},getColumnClass:function(a){switch(a){case 2:return"two-up";case 3:return"three-up";case 4:return"four-up";case 5:return"five-up";case 6:return"six-up";default:return"one-up"}}}}();return g}),define("modules/shop/ShopAmazon",["jquery","underscore"],function(a,b){"use strict";var c=function(){function d(a,b){return{count:a,name:b[a].name,brand:b[a].brand,availability:b[a].availability,href:b[a].link,image:b[a].images?b[a].images.URL:null,price:b[a].price&&b[a].price.match(/^\$\d+(?:[.,]\d+)*$/)?b[a].price:"",buttonLabel:"Buy Now",hasReviews:b[a].reviews?b[a].reviews.HasReviews:!1,reviewsHref:b[a].reviews?b[a].reviews.IFrameURL:!1,reviewsLabel:"View Amazon Customer Reviews"}}function e(a){var b=c.transmutationTable;for(var d in b)for(var e in b[d]){var g=b[d][e];f(a[d],g.values)&&(a[g.override]=g.transmute)}return a}function f(a,b){if(null===a)return!1;if("string"==typeof b)return b=null===b?"":b,-1!==a.toLowerCase().indexOf(b.toLowerCase())?!0:!1;if("object"==typeof b){for(var c in b)if(b[c]=null===b[c]?"":b[c],-1!==a.toLowerCase().indexOf(b[c].toLowerCase()))return!0;return!1}return!1}return{transmutationTable:{availability:[{values:["Out Of Stock","Has Been Discontinued","Not Stocked"],override:"buttonLabel",transmute:"Out of Stock"},{values:["Not Yet Published","Not Yet Released"],override:"buttonLabel",transmute:"Unavailable"}]},getData:function(b,c){if("function"!=typeof c)throw new Error("Callback is required in 'getData'.");var d=a(".product-page--content").length?"&product_review":"",e=b.data("products"),f=a.ajax({type:"GET",url:"/api/apai/?product_id="+e+d,dataType:"json",timeout:6e3});f.done(function(a){return c(a)}),f.fail(function(a,b,d){try{console.log(a.responseText,b,d)}catch(e){}return c(null)})},normalizeData:function(a,c){var f={headline:b.isEmpty(a.data("headline"))?"Buy it on Amazon":a.data("headline"),products:[]};for(var g in c)if(c.hasOwnProperty(g)){var h=d(g,c);h=e(h),f.products.push(h)}return f},postBuild:function(c,d){if(d.products.length){var e=d.products[0];e.hasReviews&&!b.isEmpty(e.reviewsHref)&&a("#modal-reviews div.modal-content").html('<iframe src="'+e.reviewsHref+'"/>')}}}}();return c}),define("modules/shop/ShopBazaar",["jquery"],function(a){"use strict";var b=function(){return{getData:function(b,c){if(!b.data("products"))return c(null);var d=b.data("products").split(","),e=b.data("source");if(d.length<1)return c(null);"bazaar"===e&&b.addClass("shop-source--bazaar");var f=a.ajax({type:"GET",url:"/ajax/shopbazaar/"+d,dataType:"json",timeout:6e3});f.done(function(a){var b=0;for(var d in a)a.hasOwnProperty(d)&&b++;return 1>b&&c(null),c(a)}),f.fail(function(a,b,d){try{console.log(a.responseText,b,d)}catch(e){}return c(!1)})},normalizeData:function(a,b){var c={products:[]};for(var d in b){var e=b[d],f={count:d,name:e.designer,href:e.url,image:e.images.thumbImage1,largeImage:e.images.largeImage1};switch(e.status){case"pre_order":f.buttonLabel="Pre-Order";break;case"out_of_stock":f.buttonLabel="Sold Out"}c.products.push(f)}return c}}}();return b}),define("modules/shop/ShopEditorial",[],function(){"use strict";var a=function(){return{getData:function(a,b){if("function"!=typeof b)throw new Error("Callback is required in 'getData'.");if(a.data("products")){var c=a.data("products").split(",");return b(c)}return b(null)},normalizeData:function(a,b){var c={products:[]};for(var d in b)if(b.hasOwnProperty(d)){var e=b[d],f=e.split("|");c.products.push({count:d,name:decodeURIComponent(f[0]),href:decodeURIComponent(f[1]),image:decodeURIComponent(f[2]),largeImage:decodeURIComponent(f[3])})}return c}}}();return a}),define("modules/shop/ShopRewardstyle",["jquery","underscore"],function(a,b){"use strict";var c=function(){return{getData:function(b,c){if(!b.data("products"))return c(null);var d=b.data("products").split(",");if(d.length<1)return c(null);var e=a.ajax({type:"GET",url:"/ajax/rewardstyle/"+d,dataType:"json",timeout:6e4});e.done(function(a){var b=0;for(var d in a)a.hasOwnProperty(d)&&b++;return 1>b&&c(null),c(a)}),e.fail(function(a,b,d){try{console.log(a.responseText,b,d)}catch(e){}return c(!1)})},normalizeData:function(a,c){var d={headline:b.isEmpty(a.data("headline"))?"Buy it via Rewardstyle":a.data("headline"),products:[]};for(var e in c)if(c.hasOwnProperty(e)){var f=c[e],g={count:e,name:f.designer_name,href:f.product_url,price:f.price,image:f.image,buttonLabel:"Buy Now"};d.products.push(g)}return d}}}();return c}),define("modules/VideoUnit",["jquery","modules/Utils","apis/Brightcove"],function(a,b,c){"use strict";var d=function(){return{mobile:Modernizr.mobile,videoUnit:".video-unit",videoModal:"#video-unit--modal",videoOverlay:".video-unit--overlay",videoPreview:".video-unit--preview",videoItem:".video-unit--item",videoModalItem:".video-unit--modal-item",videoThumb:".video-unit--thumb",videoTemplate:"video--template",videosPlayed:[],init:function(){var b=a(this.videoUnit);if(b.length)return this.mobile?void this.renderVideos():void this.bindEventHandlers()},bindEventHandlers:function(){a(this.videoUnit).on("click",this.videoThumb,{self:this},this.openModal).on("click",this.videoOverlay,{self:this},this.closeModal),a(window).on("complete.video.brightcove",{self:this},this.videoComplete)},modal:function(b){var c=a(this.videoModal);c.length&&b&&c.trigger(b+".app.modal")},openModal:function(b){var c=b.data.self,d=a(this),e=d.closest(c.videoItem),f=e.hasClass(c.videoModalItem.replace(".",""));e.hasClass("selected")||(f||(a(window).trigger("trending.modal.open"),c.modal("show")),c.videosPlayed=[],c.selectVideo(e))},closeModal:function(b){var c=b.data.self,d=a(b.target),e=d.hasClass(c.videoOverlay.replace(".",""));e&&a(window).trigger("trending.modal.close")},selectItem:function(b){var c=a(this.videoModalItem);"undefined"!=typeof b&&c.length&&c.removeClass("selected").eq(b).addClass("selected")},selectVideo:function(a){a.length&&(this.selectItem(a.index()),this.renderVideo(a,!1,!0))},selectNextVideo:function(b){if(b){var c=a(this.videoItem+"[data-video-id="+b+"]"),d=a(this.videoModalItem+":visible"),e=c.next();e.length&&!e.is(":hidden")||!d.length||(e=d.first()),this.selectVideo(e)}},renderVideos:function(){var b=a(this.videoItem+":not("+this.videoModalItem+"):visible");b.length&&b.each(function(b,c){var d=a(c);this.renderVideo(d,d.find(this.videoThumb))}.bind(this))},renderVideo:function(d,e,f){if(d.length){var g=a(b.renderTemplate(this.videoTemplate,{videoId:d.data("video-id"),experienceId:"trending_video_"+(d.index()+1),autostart:f}));g.length&&(e||(e=a(this.videoPreview)),e.html(g),c.renderPlayer(e),c.resize())}},videoComplete:function(c){if(!b.preventGhostClick()){var d=c.data.self,e=c.id;return b.preventGhostClick(!0,500),d.allVideosCompleted(e)?(a(window).trigger("trending.modal.autoclose"),void d.modal("hide")):void d.selectNextVideo(e)}},allVideosCompleted:function(b){var c=a(this.videoModalItem+":visible"),d=!1;if(b&&c.length)return-1===this.videosPlayed.indexOf(b)&&this.videosPlayed.push(b),this.videosPlayed.length>=c.length&&(d=!0),d}}}();return d}),define("modules/Quiz",["jquery"],function(a){"use strict";var b=function(){var b=a(window);return{messageData:{},setListener:function(){b.on("message",this.handleMessage.bind(this))},handleMessage:function(a){this.messageData=this.getJSON(a.originalEvent.data),this.messageData&&this.checkIFrame(this.messageData)},getJSON:function(a){try{return JSON.parse(a)}catch(b){return!1}},isNextPage:function(a){return"load"!==a.event||a.hasOwnProperty("module")?!1:!0},checkIFrame:function(c){this.isNextPage(c)&&a("#HMQuiz-root").offset().top<b.scrollTop()&&this.goToIFrame(a("#HMQuiz-root"))},goToIFrame:function(a){b.scrollTo(a,{offset:-70})},init:function(){a(".embed--quiz").length&&this.setListener()}}}();return b}),define("apis/Pinterest",["jquery"],function(){"use strict";var a=function(){return{getPinit:function(){require(["//assets.pinterest.com/js/pinit.js"])},init:function(){"undefined"==typeof window.parsePin&&a.getPinit()}}}();return a}),define("modules/HeaderVideoFallback",["jquery"],function(a){"use strict";var b=function(){function b(b){var c=a(b);c.prop("src",c.data("src")),c.prop("type",c.data("type"))}var c;return{init:function(){c=a(".desktop-only-video"),c.length&&(a("html.mobile").length||a("html.tablet").length?(c.find("video").prop("src",""),c.find("source").prop("src",""),c.remove()):c.each(function(){var c=a(this);c.siblings(".desktop-only-video-fallback").remove(),b(c),c.find("source").each(function(){b(a(this))}),c.find("video").load()}))}}}();return b}),define("modules/Longform",["jquery","modules/Utils","modules/Debounce","modules/Inview"],function(a,b,c){"use strict";var d=function(){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C=null,D=!1,E=!1,F=!1,G=!1,H=!1,I=0,J=0;return{nav:".nav",chapterNav:".chapter-nav",desktopLinks:".desktop-chapter-links",sideChapterNav:".side-chapter-nav",longFormBody:".longform-article",chapterBreaker:".chapter-breaker",longFormTitle:".longform-article--title",mobileChapterTitle:".mobile-chapter-label",shareFacebook:".mobile-chapter-share-social .share-button--facebook .share-button--link",shareTwitter:".mobile-chapter-share-social .share-button--twitter .share-button--link",shareEmail:".mobile-chapter-share-social .share-button--email .share-button--link",rightArrow:".pan-right",leftArrow:".pan-left",setViewport:function(){C=b.mq<b.mqs.desktop?"mobile":"desktop",this.viewportInit()},setUserAction:function(a){"object"==typeof a&&(33===a.which||34===a.which||32===a.which||38===a.which||40===a.which||a.ctrlKey&&36===a.which||a.ctrlKey&&35===a.which)&&(a=!0),G=a},setCurrentHash:function(){!G&&B&&window.scrollTo(0,a(B).offset().top)},viewportInit:function(){j.length&&"mobile"===C&&this.sideNavBuilder(),h.length&&"desktop"===C&&(this.topNavBuilder(),this.getDesktopWidths()),e.trigger({type:"applyStickyElements",currentScroll:window.pageYOffset})},bindHandlers:function(){c.on("resize","longform-resize",this.setViewport.bind(this)),d.on("adRender",this.refreshWaypoints).on("mousewheel DOMMouseScroll touchmove",this.setUserAction.bind(null,!0)),e.on("resize",this.setCurrentHash.bind(this)).on("keydown",this.setUserAction).on("click tap",".chapter-link",this.scrollToChapter.bind(this)).on("click tap",".pan-arrow",this.navArrowControls.bind(this)).on("click tap",".mobile-chapter-nav-button, .mobile-chapter-name",this.showMobileMenu.bind(this)).on("chapterReached",this.chapterReachedHandler.bind(this)),this.wayPointClassToggle(g,k,0,"content-nav-active"),h.length&&k.waypoint({handler:function(){var a=h.toggleClass("chapter-nav-active").hasClass("chapter-nav-active");g.toggleClass("sticky",a)},offset:0}),this.wayPointChapterListener()},chapterReachedHandler:function(a,b,c){history.pushState(null,null,"#"+b),this.highlightLink(b),this.updateSocial(b,c),"mobile"===C&&this.mobileChapterIndicator(b),"desktop"===C&&this.checkForNavSlide(b)},highlightLink:function(b){if(a(".current-chapter").removeClass("current-chapter"),""!==b){var c="."+b;"mobile"===C&&j.find(c).addClass("current-chapter"),"desktop"===C&&h.find(c).addClass("current-chapter")}},updateSocial:function(b,c){w="",x=m,y=v,b&&(w=a("#"+b).data("nav-title"),x+=": "+w,y+="#"+b),this.updateShareTwitter(),this.updateShareFacebook(c),this.updateShareEmail(c)},updateShareTwitter:function(){var a=y.replace("#","%23"),c=b.tweetify(x,z);c=encodeURI(c),p.attr("href",b.setUrlParams(p.attr("href"),{text:c,url:a}))},updateShareFacebook:function(a){var c=encodeURIComponent(x),d=encodeURIComponent(a),e=y.replace("#","%23");o.attr("href",b.setUrlParams(o.attr("href"),{link:y,redirect_uri:e,name:c,description:d}))},updateShareEmail:function(a){var c=encodeURIComponent(a+"\r\n"+y),d=encodeURIComponent(x);q.attr("href",b.setUrlParams(q.attr("href"),{body:c,subject:d}))},wayPointClassToggle:function(a,b,c,d){b.waypoint({handler:function(){a.toggleClass(d)},offset:c})},wayPointChapterListener:function(){l.waypoint({element:this,handler:function(b){var c=a(this.element),d=this.previous();if(F!==!0)if("down"===b)e.trigger("chapterReached",[c.attr("id"),c.data("social-dek"),c.data("nav-title"),"scroll"]);else if("up"===b)if(d){var f=a(d.element);e.trigger("chapterReached",[f.attr("id"),f.data("social-dek"),f.data("nav-title"),"scroll"])}else e.trigger("chapterReached",["","","","scroll"])},offset:20,continuous:!1,group:"chapters"})},linkBuilder:function(c){if(l.length){var d=[];return l.each(function(){var b=a(this),e=b.data("nav-title"),f="shortTitle"===c?e:b.data("side-title");d.push({navTitle:e,title:f})}),b.setTemplate(A,d)}},topNavBuilder:function(){E||(i.html(this.linkBuilder("shortTitle")),E=!0)},sideNavBuilder:function(){D||(a("#nav-panel--scrollable").remove(),j.find(".chapter-links").html(this.linkBuilder("longTitle")),a(".nav-panel").addClass("mobile-nav-active"),D=!0)},showMobileMenu:function(){e.trigger("showNavPanel")},mobileChapterIndicator:function(b){b?n.html(a("#"+b).data("nav-title")):n.html("Chapters")},scrollToChapter:function(b){var c,d,g=a(b.target).attr("href"),h=g.replace("#",""),i="",j="",k=0,l=window.pageYOffset/(window.innerHeight/50);return h&&(c=a(g),i=c.data("social-dek"),j=c.data("nav-title"),k=c.offset().top,l=k/(window.innerHeight/50)),F=!0,this.setUserAction(!0),f.animate({scrollTop:k},l,function(){F=!1,B=h?g:null,this.setUserAction(!1)}.bind(this)),"mobile"===C&&(d="mobile click",e.trigger("closeNavPanel")),"desktop"===C&&(d="desktop click"),h||e.trigger({type:"applyStickyElements",currentScroll:0}),e.trigger("chapterReached",[h,i,j,d]),!1},getDesktopWidths:function(){var a=i.outerWidth();t=d.outerWidth(),a>t?(H=!0,u=t/2,J=a-t,this.navArrowDisplay()):H=!1},checkForNavSlide:function(b){if(b&&H){var c=a(".desktop-chapter-links ."+b),d=c.offset().left,e=t-d-c.outerWidth(),f=a(".single-chapter-link:first").offset().left;d>u&&I!==J&&this.navSlider(b),e>u&&0>f&&this.navSlider(b)}},navSlider:function(b){var c=a(".desktop-chapter-links ."+b),d=c.offset().left,e=u-c.outerWidth()/2,f=d-e,g=f+I;I=g>J?J:g,this.slideNav(I),this.navArrowDisplay()},navArrowControls:function(b){var c=a(b.currentTarget);c.hasClass("pan-left")?I-=500:c.hasClass("pan-right")&&(I+=500),I>J&&(I=J),this.slideNav(I),this.navArrowDisplay()},navArrowDisplay:function(){s.toggleClass("pannable",I>0),r.css("right",J),r.toggleClass("pannable",I!==J)},slideNav:function(a){i.css("transform","translateX(-"+a+"px)")},getLocationHREF:function(){var a=window.location.href;return a=a.split("?")[0],a=a.split("#")[0]},refreshWaypoints:function(){setTimeout(function(){Waypoint.refreshAll()},100)},init:function(){d=a(window),e=a(document),f=a("html, body"),g=a(this.nav),h=a(this.chapterNav),i=a(this.desktopLinks),j=a(this.sideChapterNav),k=a(this.longFormBody),l=a(this.chapterBreaker),m=a(this.longFormTitle).text(),n=a(this.mobileChapterTitle),o=a(this.shareFacebook),p=a(this.shareTwitter),q=a(this.shareEmail),r=a(this.rightArrow),s=a(this.leftArrow),A=b.getTemplate("chapter--list"),B=window.location.hash,a(".content-nav").length&&k.length&&(t=d.outerWidth(),v=this.getLocationHREF(),z=" via @"+p.data("site-handle"),this.setCurrentHash(),this.setViewport(),this.bindHandlers())}}}();return d}),define("modules/Playlist",["jquery","underscore","modules/Utils","modules/Images"],function(a,b,c,d){"use strict";var e=function(){var e,f,g,h,i,j,k,l;return{touch:Modernizr.touch,moving:!1,scrollListener:!0,lastScroll:0,lastItemLoaded:0,direction:null,
playlist:".playlist",plThumbsWrapper:".playlist-thumbs--wrapper",plThumbsInnerWrap:".playlist-thumbs--inner-wrap",plThumb:".playlist-thumb",plArrow:".playlist-arrow",plThumbTemplate:"playlist-item--template",plIframeId:"",init:function(){e=a(this.playlist),e.length&&(f=e.find("iframe"),g=a(this.plThumbsWrapper),h=a(this.plThumbsInnerWrap),i=a(this.plThumb),l=c.getTemplate(this.plThumbTemplate),this.plIframeId=f.attr("id"),j=e.data("playlistId"),k=e.data("total"),this.bindEventHandlers(),this.scrollToThumb(h.find(".selected")))},bindEventHandlers:function(){e.on("click",this.plThumb,this.selectVideo.bind(this)).on("click",this.plArrow,this.scrollThumbs.bind(this)),g.on("scroll",b.debounce(this.handleThumbScroll.bind(this),250)).on("scroll",this.loadImages),a(window).on("render.app.video.ended",this.videoEnded.bind(this))},selectVideo:function(b){var c,d=a(b.currentTarget),e=d.data("video"),g="https://www.youtube.com/embed/"+e+"?enablejsapi=1";d.hasClass("selected")||(c=f.video(),i.removeClass("selected"),d.addClass("selected"),this.touch?(c.getIframe().src=g,f.video(!1,!0)):c.loadVideoById(e))},videoEnded:function(b){var c,d=b.id;d===this.plIframeId&&(c=a(this.plThumb+".selected").next(),c.length&&this.scrollToThumb(c,!0,function(){c.click()}))},scrollThumbs:function(b){var c=a(b.currentTarget),d=g.scrollLeft(),e=g.width(),f=c.hasClass("left-arrow")?-Math.abs(e):e;this.moving||!this.scrollListener&&"prev"===this.direction||(this.moving=!0,g.animate({scrollLeft:d+f},500,function(){this.moving=!1}.bind(this)))},scrollToThumb:function(b,c,d){var e,f;if(b)return d=d?d:a.noop,e=i.outerWidth(!0)*b.index(),f=e-g.width()/3,c&&e<=g.scrollLeft()+g.width()?void d():void g.animate({scrollLeft:f},c?500:0,d)},loadImages:function(){var b=i.find(".lazy-image");b.length&&a(window).scroll()},handleThumbScroll:function(){var a,b;this.scrollListener&&i.length!==k&&(a=this.getItem(),b=a?a.data("index"):0,b&&b!==this.lastItemLoaded&&(this.lastItemLoaded=b,this.scrollListener=!1,this.loadItems(b,this.direction,this.renderItems)))},getItem:function(){var a,b=g.scrollLeft(),c=h.width()-g.width();return b>this.lastScroll?(this.direction="next",b>Math.round(.8*c)&&(a=i.last())):(this.direction="prev",b<Math.round(.2*c)&&(a=i.first())),this.lastScroll=b,a},renderItems:function(b){var e="";if(!b.items||!b.items.length)return void(this.scrollListener=!0);for(var f=0,g=b.items.length;g>f;f++)e+=c.setTemplate(l,b.items[f]).trim();this.appendItems(e,b.itemCount),i=a(this.plThumb),d.setupLazyImages(i.find(".lazy-image"))},appendItems:function(a,b){var c,d=i.first(),e=g.scrollLeft();"next"===this.direction?(h.append(a),this.scrollListener=!0):"prev"===this.direction&&(c=e+i.outerWidth(!0)*b,d.before(a),g.scrollLeft(c).animate({scrollLeft:c},0,function(){this.scrollListener=!0}.bind(this)))},loadItems:function(b,c,d){d=d||a.noop;var e={type:"GET",url:"/ajax/playlist/",data:{id:j,pos:b,dir:c},dataType:"json",context:this};a.ajax(e).done(d).fail(this.handleAjaxError)},handleAjaxError:function(a,b,c){this.scrollListener=!0;try{console.warn("Playlist thumbnails failed with: ",a,b,c)}catch(d){}}}}();return e}),define("modules/ContentLinks",["jquery","modules/Debounce","modules/Utils"],function(a){"use strict";return{init:function(){this.setVariables(),this.setListeners(),this.clearfixLastParent()},setVariables:function(){this.selectors={embed:".embed--contentlinks",embedAlign:".editorial--left, .editorial--center",links:".embed-contentlink",storyList:".editorial-story-list",storyTitle:".editorial-story--title",storyNumbered:".editorial-story--numbered",storyTitleText:".editorial-story--title-text"},this.$window=a(window),this.$contentLinksEmbed=a(this.selectors.embed)},setListeners:function(){this.$contentLinksEmbed.length&&this.$contentLinksEmbed.on("click",this.selectors.links,this.triggerDataEvent.bind(this))},clearfixLastParent:function(){var a=this.$contentLinksEmbed.last();a.length&&a.is(this.selectors.embedAlign)&&a.parent().addClass("clearfix")},triggerDataEvent:function(b){var c=a(b.target),d=c.closest(this.selectors.storyList),e={type:"track.editorial.recirc.link.clicked",href:c.attr("href")};d.length&&this.$window.trigger(a.extend(e,d.data()))}}}),define("modules/Inview",["jquery","modules/Utils"],function(a,b){"use strict";var c=function(){return{elements:null,desktopNavHeightOffset:90,mobileNavHeightOffset:0,mobileView:b.mq<b.mqs.desktop,selectors:["h1","h2","h3","h4",".tip",".pullquote","blockquote",".dropcap",".longform-article-body-el-image"],bindEvents:function(){a.each(this.elements,this.addWaypoint.bind(this))},addWaypoint:function(b,c){var d=a(c);d.addClass("anim-in-view"),new Waypoint.Inview({element:d,enter:this.toggleClass.bind(d,"enter"),entered:this.toggleClass.bind(d,"entered"),exit:this.toggleClass.bind(d,"exit"),exited:this.toggleClass.bind(d,"exited"),offset:{top:this.mobileView?0:this.desktopNavHeightOffset,bottom:this.mobileView?this.mobileNavHeightOffset:0}})},toggleClass:function(b){a(this).toggleClass("in-view","exited"!==b)},init:function(){this.elements=a(this.selectors.join(", ")),this.elements.length&&this.bindEvents()}}}();return c}),define("modules/Recirc",["jquery","modules/Debounce"],function(a,b){"use strict";var c=function(){function c(){b.on("scroll","recirc",d)}function d(){a.inviewport(e,{threshold:0,container:window})&&(b.off("scroll","recirc"),a.event.trigger({type:"right-rail-in-view"}))}var e;return{init:function(){e=a(".recirc-standard-secondary"),e.length&&c()}}}();return c}),define("article",["modules/ArticleEmbeds","apis/Brightcove","modules/LeftRail","modules/StickyShare","modules/shop/Shop","modules/shop/ShopAmazon","modules/shop/ShopBazaar","modules/shop/ShopEditorial","modules/shop/ShopRewardstyle","modules/VideoUnit","modules/Quiz","apis/Pinterest","modules/HeaderVideoFallback","modules/Longform","modules/Playlist","modules/ContentLinks","modules/Inview","modules/Recirc"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){var s=function(){a.init(),b.init(),c.init(),j.init(),k.init(),n.init(),o.init(),p.init(),q.init(),r.init()};$(function(){d.init(),l.init(),m.init()}),"complete"===document.readyState?s():$(window).on("load",s)}),require(["article"]);